INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/../include)
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/../src)
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR}/../include)
CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/../include/libcueify/types.h.in
               ${CMAKE_CURRENT_BINARY_DIR}/../include/libcueify/types.h)
LINK_LIBRARIES(cueify)

ENABLE_TESTING()

FIND_PACKAGE(LibCheck)
IF(LIBCHECK_FOUND)
    INCLUDE_DIRECTORIES(${LIBCHECK_INCLUDE_DIRS})
    LINK_LIBRARIES(${LIBCHECK_LIBRARIES})
    
    ADD_CUSTOM_TARGET(check COMMAND ${CMAKE_CTEST_COMMAND} --output-on-failure)
    
    ADD_EXECUTABLE(check_toc check_toc.c)
    ADD_TEST(check_toc check_toc)
    ADD_DEPENDENCIES(check check_toc)
ENDIF(LIBCHECK_FOUND)

IF(CMAKE_COMPILER_IS_GNUCC)
    SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall -Werror -Wextra")
ENDIF(CMAKE_COMPILER_IS_GNUCC)
